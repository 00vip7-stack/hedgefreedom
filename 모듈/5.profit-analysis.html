<!-- 파일을 원본 상태로 복구: 계산기, 안내 카드, 안내문, 버튼 등 포함 -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5. 손익분석</title>
    <style>
                .grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
                    gap: 16px;
                    margin-bottom: 12px;
                    align-items: start;
                }
                .card {
                    background: #fff;
                    border: 1px solid #e0e0e0;
                    border-radius: 8px;
                    padding: 18px 16px;
                    box-sizing: border-box;
                    margin-bottom: 0;
                    display: flex;
                    flex-direction: column;
                    justify-content: flex-start;
                    width: 100%;
                    min-width: 0; /* allow flex/grid to manage sizing */
                    overflow: visible;
                }
                .card-title {
                    font-size: 15px;
                    font-weight: bold;
                    color: #1976d2;
                    margin-bottom: 12px;
                }
                .input-row {
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    margin-bottom: 6px;
                }
                .input-label {
                    min-width: 90px;
                    font-size: 13px;
                    color: #333;
                    white-space: nowrap;
                    text-align: right;
                    padding-right: 8px;
                    box-sizing: border-box;
                }
                .input-box {
                    flex: 0 0 120px;
                    padding: 6px 8px;
                    font-size: 13px;
                    border: 1px solid #bbb;
                    border-radius: 3px;
                }
                .slider {
                    flex: 1 1 auto;
                }
                .result {
                    margin-top: 6px;
                    font-size: 14px;
                    color: #388e3c;
                    font-weight: bold;
                }
        body { font-family: "Malgun Gothic", "맑은 고딕", Dotum, "돋움", sans-serif; background: #eef1f6; color: #333; margin: 0; }
        .header { background: #fff; border-bottom: 2px solid #4a90e2; height: 45px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; }
        .logo { font-size: 14px; font-weight: bold; color: #4a90e2; padding: 0 10px; border-right: 1px solid #ddd; flex: 0 0 auto; }
        #fx-rate-header { flex: 1 1 auto; text-align: right; }
        .menu-bar { background: #fff; border-bottom: 1px solid #ddd; height: 35px; display: flex; align-items: center; padding: 0 10px; }
        .menu-item { padding: 8px 15px; min-width: 90px; text-align: center; color: #555; cursor: pointer; font-size: 12px; border-right: 1px solid #e5e5e5; background: #fafafa; text-decoration: none; display: inline-block; box-sizing: border-box; }
        .menu-item:last-child { border-right: none; }
        .menu-item.active { background: #4a90e2; color: #fff; font-weight: bold; }
        .workspace { padding: 20px; max-width: 1200px; margin: 0 auto; }
        .page-title { background: #fff; padding: 10px 15px; margin-bottom: 18px; border: 1px solid #ddd; font-size: 15px; font-weight: bold; color: #333; display: flex; justify-content: space-between; align-items: center; }
        .breadcrumb { font-size: 11px; color: #999; font-weight: normal; }
    </style>
</head>
<body>
    <!-- Ensure header consistency with 2.trade-input.html -->
    <div class="header">
        <div class="logo">HEDGEFREEDOM</div>
        <div id="fx-rate-header" style="font-size:13px; color:#1976d2; margin-left:auto; display:flex; gap:18px; align-items:center;">
            <span><b>USD/KRW</b> 1,325.50 <span style="color:#d32f2f;">+2.10</span> <span style="font-size:11px; color:#888;">(+0.16%)</span></span>
            <span><b>EUR/KRW</b> 1,420.80 <span style="color:#1976d2;">-1.50</span> <span style="font-size:11px; color:#888;">(-0.11%)</span></span>
            <span><b>JPY/KRW</b> 9.85 <span style="color:#d32f2f;">+0.02</span> <span style="font-size:11px; color:#888;">(+0.20%)</span></span>
            <span style="border-left:1px solid #e0e0e0; padding-left:14px; color:#333;">
                <b>달러인덱스(DXY)</b> 104.25 <span style="color:#1976d2;">+0.12</span> <span style="font-size:11px; color:#888;">(+0.11%)</span>
            </span>
        </div>
    </div>
    <div class="menu-bar">
        <a href="1.dashboard.html" class="menu-item">대시보드</a>
        <a href="2.trade-input.html" class="menu-item">거래관리</a>
        <a href="3.internal-hedge.html" class="menu-item">내부헤지</a>
        <a href="4.hedge-strategy.html" class="menu-item">외부헤지</a>
        <a href="5.profit-analysis.html" class="menu-item active">손익분석</a>
        <a href="6.report.html" class="menu-item">리포트</a>
        <a href="7.excel-upload.html" class="menu-item">엑셀업로드</a>
        <a href="8.competitor-pricing.html" class="menu-item">경쟁사 가격비교</a>
    </div>
    <div class="workspace">
        <div class="page-title">
            <div>손익분석</div>
            <div class="breadcrumb">홈 / 손익분석</div>
        </div>

        <div class="section">
            <div class="section-title">계산기 모음</div>
            <div class="grid" style="margin-top:8px;">
                <div class="card">
                    <div class="card-title">선물환 손익 계산기</div>
                    <div class="input-row"><span class="input-label">계약금액</span><input type="number" id="fw_amt" class="input-box" value="1000"></div>
                    <div class="input-row"><span class="input-label">계약환율</span><input type="number" id="fw_rate" class="input-box" value="1330"></div>
                    <div class="input-row"><span class="input-label">만기환율</span><input type="number" id="fw_exp" class="input-box" value="1340"></div>
                    <div class="input-row"><button onclick="fwCalc()">손익계산</button></div>
                    <div class="result" id="fw_result"></div>
                </div>

                <div class="card">
                    <div class="card-title">달러선물 손익 계산기</div>
                    <div class="input-row"><span class="input-label">계약수량</span><input type="number" id="fut_qty" class="input-box" value="1"></div>
                    <div class="input-row"><span class="input-label">진입가</span><input type="number" id="fut_entry" class="input-box" value="1330"></div>
                    <div class="input-row"><span class="input-label">청산가</span><input type="number" id="fut_exit" class="input-box" value="1340"></div>
                    <div class="input-row"><button onclick="futCalc()">손익계산</button></div>
                    <div class="result" id="fut_result"></div>
                </div>
                <div class="card">
                    <div class="card-title">환변동보험 손익 계산기</div>
                    <div class="input-row"><span class="input-label">보험금액</span><input type="number" id="ins_amt" class="input-box" value="1000"></div>
                    <div class="input-row"><span class="input-label">기준환율</span><input type="number" id="ins_base" class="input-box" value="1330"></div>
                    <div class="input-row"><span class="input-label">만기환율</span><input type="number" id="ins_exp" class="input-box" value="1340"></div>
                    <div class="input-row"><button onclick="insCalc()">손익계산</button></div>
                    <div class="result" id="ins_result"></div>
                </div>

                <div class="card">
                    <div class="card-title">슬라이드 환차손익</div>
                    <div class="input-row"><span class="input-label">금액</span><input type="number" id="amount2" class="input-box" value="1000"></div>
                    <div class="input-row"><span class="input-label">매입환율</span><input type="number" id="buy2" class="input-box" value="1320"></div>
                    <div class="input-row"><span class="input-label">매도환율</span><input type="range" id="sell2" class="slider" min="1200" max="1500" value="1330" oninput="document.getElementById('sell2val').innerText=this.value"><span id="sell2val" style="min-width:52px; text-align:center; display:inline-block;">1330</span></div>
                    <div class="input-row"><button onclick="calc2()">손익계산</button></div>
                    <div class="result" id="result2"></div>
                </div>

                <div class="card">
                    <div class="card-title">수수료 계산기</div>
                    <div class="input-row"><span class="input-label">거래금액</span><input type="number" id="amount3" class="input-box" value="1000"></div>
                    <div class="input-row"><span class="input-label">수수료율(%)</span><input type="number" id="fee3" class="input-box" value="0.2"></div>
                    <div class="input-row"><button onclick="calc3()">계산</button></div>
                    <div class="result" id="result3"></div>
                </div>

                <div class="card">
                    <div class="card-title">헤지비율 슬라이드</div>
                    <div class="input-row"><span class="input-label">노출금액</span><input type="number" id="exposure6" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현물환율</span><input type="number" id="spot6" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">헤지비율</span><input type="range" id="hedgeSlider6" class="slider" min="0" max="100" value="50" oninput="updateHedge6(); recalc6()"><span id="hedgeDisplay6" style="min-width:52px; text-align:center; display:inline-block;">50%</span></div>
                    <div class="result" id="var6"></div>
                </div>
                <div class="card">
                    <div class="card-title">기대손익 슬라이드</div>
                    <div class="input-row"><span class="input-label">노출금액</span><input type="number" id="exposure8" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현물환율</span><input type="number" id="spot8" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">기대손익%</span><input type="range" id="pnlPctSlider8" class="slider" min="0" max="200" value="100" oninput="updatePnl8(); recalc8()"><span id="pnlPctDisplay8" style="min-width:52px; text-align:center; display:inline-block;">0.0%</span></div>
                    <div class="result" id="pnl8"></div>
                </div>

                <div class="card">
                    <div class="card-title">환율 시나리오 슬라이더</div>
                    <div class="input-row"><span class="input-label">외화금액</span><input type="number" id="exposure5" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현재환율</span><input type="number" id="spot5" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">포지션</span><select id="positionType5" class="input-box"><option value="asset">자산</option><option value="liability">부채</option></select></div>
                    <div class="input-row"><span class="input-label">시나리오환율</span><input type="range" id="scenarioSlider5" class="slider" min="1000" max="2000" value="1500" oninput="updateScenario5(); recalc5()"><span id="scenarioDisplay5" style="min-width:52px; text-align:center; display:inline-block;">1500</span></div>
                    <div class="result" id="scenarioPnL5"></div>
                </div>

                <div class="card">
                    <div class="card-title">헤지효과성 슬라이드</div>
                    <div class="input-row"><span class="input-label">노출금액</span><input type="number" id="exposure7" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현물환율</span><input type="number" id="spot7" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">헤지비율</span><input type="number" id="hedgeRatio7" class="input-box" value="50"></div>
                    <div class="input-row"><span class="input-label">효과성</span><input type="range" id="effSlider7" class="slider" min="0" max="100" value="80" oninput="updateEff7(); recalc7()"><span id="effDisplay7" style="min-width:52px; text-align:center; display:inline-block;">80%</span></div>
                    <div class="result" id="var7"></div>
                </div>

                <div class="card">
                    <div class="card-title">기대손익 슬라이드</div>
                    <div class="input-row"><span class="input-label">노출금액</span><input type="number" id="exposure8" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현물환율</span><input type="number" id="spot8" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">기대손익%</span><input type="range" id="pnlPctSlider8" class="slider" min="0" max="200" value="100" oninput="updatePnl8(); recalc8()"><span id="pnlPctDisplay8" style="min-width:52px; text-align:center; display:inline-block;">0.0%</span></div>
                    <div class="result" id="pnl8"></div>
                </div>

                <div class="card">
                    <div class="card-title">선물환 헤지 계산기</div>
                    <div class="input-row"><span class="input-label">헤지금액</span><input type="number" id="totalFx9" class="input-box" value="680000"></div>
                    <div class="input-row"><span class="input-label">계약단위</span><input type="number" id="lotSize9" class="input-box" value="100000"></div>
                    <div class="input-row"><span class="input-label">헤지비율</span><input type="range" id="ratio9" class="slider" min="0" max="100" value="73" oninput="updateRatio9(); recalc9()"><span id="ratioLabel9" style="min-width:52px; text-align:center; display:inline-block;">73%</span></div>
                    <div class="result" id="hedgeResult9"></div>
                </div>

                <div class="card">
                    <div class="card-title">환율 스트레스 테스트</div>
                    <div class="input-row"><span class="input-label">노출금액</span><input type="number" id="exposure10" class="input-box" value="1000000"></div>
                    <div class="input-row"><span class="input-label">현재환율</span><input type="number" id="spot10" class="input-box" value="1350" step="0.1"></div>
                    <div class="input-row"><span class="input-label">포지션</span><select id="positionType10" class="input-box"><option value="asset">자산</option><option value="liability">부채</option></select></div>
                    <div class="input-row"><span class="input-label">스트레스%</span><input type="range" id="shockSlider10" class="slider" min="0" max="600" value="360" oninput="updateShock10(); recalc10()"><span id="shockDisplay10" style="min-width:52px; text-align:center; display:inline-block;">+10.0%</span></div>
                    <div class="result" id="stressPnL10"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">참고자료</div>
            <div style="display:flex; gap:12px; flex-wrap:wrap;">
                <div class="card" style="max-width:420px;">
                    <div class="card-title">통화옵션 안내</div>
                    <div style="font-size:13px; color:#555;">통화옵션(통화콜/풋)은 환율 변동에 따라 권리 행사로 손익이 결정되는 파생상품입니다. 실전 활용은 전문가 상담이 필요합니다.</div>
                </div>
                <div class="card" style="max-width:420px;">
                    <div class="card-title">통화선물 안내</div>
                    <div style="font-size:13px; color:#555;">통화선물은 표준화된 계약 단위로 거래되는 환헤지 파생상품입니다. 기본 구조와 리스크를 반드시 숙지 후 활용하세요.</div>
                </div>
            </div>
        </div>

    </div>
    <script>
        function calc1() {
            var amt = parseFloat(document.getElementById('amount1').value)||0;
            var rate = parseFloat(document.getElementById('rate1').value)||0;
            document.getElementById('result1').innerText = amt && rate ? (amt * rate).toLocaleString() + '원' : '';
        }
        function calc2() {
            var amt = parseFloat(document.getElementById('amount2').value)||0;
            var buy = parseFloat(document.getElementById('buy2').value)||0;
            var sell = parseFloat(document.getElementById('sell2').value)||0;
            var profit = (sell - buy) * amt;
            document.getElementById('result2').innerText = amt && buy && sell ? profit.toLocaleString() + '원' : '';
        }
        function calc3() {
            var amt = parseFloat(document.getElementById('amount3').value)||0;
            var fee = parseFloat(document.getElementById('fee3').value)||0;
            document.getElementById('result3').innerText = amt && fee ? ((amt * fee/100).toLocaleString() + '원') : '';
        }
        function calc4() {
            var amt = parseFloat(document.getElementById('amount4').value)||0;
            var hedge = parseFloat(document.getElementById('hedge4').value)||0;
            document.getElementById('result4').innerText = amt && hedge ? ((amt * hedge/100).toLocaleString() + '원') : '';
        }
        function updateScenario5() {
            var v = parseFloat(document.getElementById('scenarioSlider5').value) || 0;
            document.getElementById('scenarioDisplay5').innerText = v;
        }
        function updateScenario5() {
            var v = parseFloat(document.getElementById('scenarioSlider5').value) || 0;
            document.getElementById('scenarioDisplay5').innerText = v;
        }
        function recalc5() {
            var exposure = parseFloat(document.getElementById('exposure5').value) || 0;
            var spot = parseFloat(document.getElementById('spot5').value) || 0;
            var posType = document.getElementById('positionType5').value;
            var scenRate = parseFloat(document.getElementById('scenarioSlider5').value) || 0;
            var baseNotionalKRW = exposure * spot;
            var scenNotionalKRW = exposure * scenRate;
            var pnlKRW = 0;
            if (posType === 'asset') {
                pnlKRW = scenNotionalKRW - baseNotionalKRW;
            } else {
                pnlKRW = baseNotionalKRW - scenNotionalKRW;
            }
            document.getElementById('scenarioPnL5').innerText = pnlKRW ? pnlKRW.toLocaleString() + '원' : '';
        }
        function updateHedge6() {
            var v = parseFloat(document.getElementById('hedgeSlider6').value) || 0;
            document.getElementById('hedgeDisplay6').innerText = v + '%';
        }
        function recalc6() {
            var exposure = parseFloat(document.getElementById('exposure6').value) || 0;
            var spot = parseFloat(document.getElementById('spot6').value) || 0;
            var hedgeRatio = parseFloat(document.getElementById('hedgeSlider6').value) / 100 || 0;
            var notionalKRW = exposure * spot;
            var hedgedVol = 12 * (1 - hedgeRatio); // 간단 가정
            var varKRW = 1.65 * (hedgedVol / 100) * notionalKRW * Math.sqrt(90/365); // 간단 VaR
            document.getElementById('var6').innerText = varKRW ? (varKRW / 1e8).toFixed(1) + '억원' : '';
        }
        function updateEff7() {
            var v = parseFloat(document.getElementById('effSlider7').value) || 0;
            document.getElementById('effDisplay7').innerText = v + '%';
        }
        function recalc7() {
            var exposure = parseFloat(document.getElementById('exposure7').value) || 0;
            var spot = parseFloat(document.getElementById('spot7').value) || 0;
            var hedgeRatio = parseFloat(document.getElementById('hedgeRatio7').value) / 100 || 0;
            var eff = parseFloat(document.getElementById('effSlider7').value) / 100 || 0;
            var notionalKRW = exposure * spot;
            var hedgedVol = 12 * (1 - hedgeRatio * eff);
            var varKRW = 1.65 * (hedgedVol / 100) * notionalKRW * Math.sqrt(90/365);
            document.getElementById('var7').innerText = varKRW ? (varKRW / 1e8).toFixed(1) + '억원' : '';
        }
        function updatePnl8() {
            var slider = document.getElementById('pnlPctSlider8');
            var v = parseInt(slider.value, 10);
            var pct = v / 10 - 10;
            document.getElementById('pnlPctDisplay8').innerText = pct.toFixed(1) + '%';
        }
        function recalc8() {
            var exposure = parseFloat(document.getElementById('exposure8').value) || 0;
            var spot = parseFloat(document.getElementById('spot8').value) || 0;
            var slider = document.getElementById('pnlPctSlider8');
            var v = parseInt(slider.value, 10);
            var pct = v / 10 - 10;
            var notionalKRW = exposure * spot;
            var pnlKRW = notionalKRW * (pct / 100);
            document.getElementById('pnl8').innerText = pnlKRW ? pnlKRW.toLocaleString() + '원' : '';
        }
        function updateRatio9() {
            var v = parseFloat(document.getElementById('ratio9').value) || 0;
            document.getElementById('ratioLabel9').innerText = v + '%';
        }
        function recalc9() {
            var totalFx = parseFloat(document.getElementById('totalFx9').value) || 0;
            var lotSize = parseFloat(document.getElementById('lotSize9').value) || 0;
            var ratio = parseFloat(document.getElementById('ratio9').value) / 100 || 0;
            var targetHedge = totalFx * ratio;
            var lots = Math.floor(targetHedge / lotSize);
            var covered = lots * lotSize;
            var remain = totalFx - covered;
            var actualRatio = totalFx > 0 ? (covered / totalFx * 100).toFixed(1) : 0;
            document.getElementById('hedgeResult9').innerText = '실제비율: ' + actualRatio + '%, 계약수: ' + lots + ', 잔액: ' + remain.toLocaleString();
        }
        function updateShock10() {
            var slider = document.getElementById('shockSlider10');
            var v = parseInt(slider.value, 10);
            var pct = (v / 10) - 30;
            document.getElementById('shockDisplay10').innerText = (pct >= 0 ? '+' : '') + pct.toFixed(1) + '%';
        }
        function recalc10() {
            var exposure = parseFloat(document.getElementById('exposure10').value) || 0;
            var spot = parseFloat(document.getElementById('spot10').value) || 0;
            var posType = document.getElementById('positionType10').value;
            var slider = document.getElementById('shockSlider10');
            var v = parseInt(slider.value, 10);
            var pct = (v / 10) - 30;
            var stressRate = spot * (1 + pct / 100);
            var baseNotional = exposure * spot;
            var stressNotional = exposure * stressRate;
            var pnlKRW = 0;
            if (posType === 'asset') {
                pnlKRW = stressNotional - baseNotional;
            } else {
                pnlKRW = baseNotional - stressNotional;
            }
            document.getElementById('stressPnL10').innerText = pnlKRW ? pnlKRW.toLocaleString() + '원' : '';
        }
        document.addEventListener('DOMContentLoaded', function() {
            updateScenario5();
            recalc5();
            document.getElementById('exposure5').addEventListener('input', recalc5);
            document.getElementById('spot5').addEventListener('input', recalc5);
            document.getElementById('positionType5').addEventListener('change', recalc5);
            updateHedge6();
            recalc6();
            document.getElementById('exposure6').addEventListener('input', recalc6);
            document.getElementById('spot6').addEventListener('input', recalc6);
            updateEff7();
            recalc7();
            document.getElementById('exposure7').addEventListener('input', recalc7);
            document.getElementById('spot7').addEventListener('input', recalc7);
            document.getElementById('hedgeRatio7').addEventListener('input', recalc7);
            updatePnl8();
            recalc8();
            document.getElementById('exposure8').addEventListener('input', recalc8);
            document.getElementById('spot8').addEventListener('input', recalc8);
            updateRatio9();
            recalc9();
            document.getElementById('totalFx9').addEventListener('input', recalc9);
            document.getElementById('lotSize9').addEventListener('input', recalc9);
            updateShock10();
            recalc10();
            document.getElementById('exposure10').addEventListener('input', recalc10);
            document.getElementById('spot10').addEventListener('input', recalc10);
            document.getElementById('positionType10').addEventListener('change', recalc10);
        });
    </script>
</body>
</html>
